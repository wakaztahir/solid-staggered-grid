import{d as re,e as oe,b as W,n as ae,p as X,o as Z,c as _,m as N,D as se,g as O,i as ee,F as ue,f as m,l as de,j as K,S as Q,a as ce,q as te,v as ge,r as me,s as he,k as fe,t as D}from"./entry-client-c4ec3e8d.js";var R=(t=>(t[t.Start=0]="Start",t[t.Center=1]="Center",t[t.End=2]="End",t))(R||{});const pe={updateItem:()=>{},removeItem:()=>{}},ne=re(pe);function be(){return oe(ne)}const q={alignment:R.Center,calculateHeight:!0,useElementWidth:!1,horizontalGap:0,verticalGap:0,repositionOnResize:!0,fitHorizontalGap:!1,requestAppendScrollTolerance:20};function ye(t,r){const[h,b]=W();let w=!1,c,s=[],a;function o(){return r.options?r.options():void 0}function f(e){e.requestReposition=g,e.reposition=S,e.attachOnScrollListener=()=>{document.addEventListener("scroll",l)},e.deAttachOnScrollListener=()=>{document.removeEventListener("scroll",l)},e.attachOnResize=()=>{window.addEventListener("resize",$)},e.deAttachOnResize=()=>{window.removeEventListener("resize",$)},e.isRegistered=!0}r.gridController!=null&&f(r.gridController);function y(e){if(e.gridWidth!=null)return e.gridWidth;{let n=v(e),i=t();if(n!=null&&e.columnWidth!=null&&!e.useElementWidth)return n*e.columnWidth;if(i!=null){const d=i.clientWidth;return d==null||d==0?(console.error("gridWidth is zero , gridWidth prop || css width property should be given to StaggeredGrid"),0):d}else return 0}}function v(e){if(e.columns!=null&&e.columns>0)return Math.max(1,Math.min(s.length,e.columns))}function x(e,n){if(e.columnWidth!=null)return e.columnWidth;{let i=v(e);return i!=null?n/i:(console.error("columnWidth is zero , columns || columnWidth prop not given to StaggeredGrid"),260)}}function P(e,n,i,d){let E=x(e,n);return e.fitHorizontalGap&&(E-=(i-1)*d/i),E}function G(e,n){return v(e)||Math.max(1,Math.min(s.length,Math.ceil(n/x(e,n))-1))}function S(e){try{const n=e;if(s.length===0)return;c=y(n);const i=G(n,c);if(i<1)return;const d=n.horizontalGap||q.horizontalGap,E=n.verticalGap||q.verticalGap,T=P(n,c,i,d),U=i*T+(i-1)*d;let F=0,I=0;const M=Array(i).fill(0);let V=0;n.alignment===R.Center?V=(c-U)/2:n.alignment===R.End&&(V=c-U);for(let k=0;k<s.length;k++){let z=s[k];if(z.mounted)try{const H=Math.max(1,Math.min(z.itemColumnSpan,i)),Y=H*T+Math.max(H-1,0)*d,J=z.itemHeight;let j,B=0;if(I+H<=i?j=F:(I=0,j=0,F=0),H===1)B=M[I],M[I]+=J+E;else if(H>1){let A=0;for(let L=I;L<I+H;L++)M[L]>A&&(A=M[L]);B=A;for(let L=I;L<I+H;L++)M[L]=A+J+E}F+=Y+d,I+=H,z.update(Y,V+j,B)}catch(H){console.warn(H)}}if(n.calculateHeight){let k=0;for(let z=0;z<M.length;z++)M[z]>k&&(k=M[z]);h()!==k&&b(k)}w=!0}catch(n){console.error(n)}}function g(e){a==null&&(a=window.requestAnimationFrame(()=>{a=void 0,S(e)}))}function $(){const e=o();e&&g(e)}function l(){const e=o();if(!e)return;let n=t();if(n==null||h()==null){e.calculateHeight||console.warn("calculateHeight must be true for requestAppend to work !");return}const i=n.getBoundingClientRect().top-(n.offsetParent?.getBoundingClientRect().top||0);(window.scrollY||window.pageYOffset)+window.innerHeight-i>=n.scrollHeight-(e.requestAppendScrollTolerance||q.requestAppendScrollTolerance)&&e.requestAppend!=null&&e.requestAppend()}function u(){let e;return(r.options||(()=>q))().calculateHeight&&h()!=null?e={height:h()+"px"}:e={},e}function p(e,n,i,d){let E=!1;if(s[e]!=null?((n!==s[e].itemColumnSpan||i!==s[e].itemHeight)&&(E=!0),s[e].itemColumnSpan=n,s[e].itemHeight=i,s[e].update=d,s[e].mounted=!0):s[e]={itemColumnSpan:n,itemHeight:i,update:d,mounted:!0},E&&w){const T=o();T&&g(T)}}function C(e){if(s[e]!=null){s[e].mounted=!1;const n=o();n&&g(n)}}return ae(()=>{const e=o();e&&e.repositionOnResize&&window.addEventListener("resize",$),e&&e.requestAppend!=null&&document.addEventListener("scroll",l)}),X(()=>{const e=o();e&&g(e),r.gridController!=null&&!r.gridController.isRegistered&&f(r.gridController)}),Z(()=>{{const e=o();e&&e.repositionOnResize&&window.removeEventListener("resize",$),e&&e.requestAppend!=null&&document.removeEventListener("scroll",l)}}),{updateItem:p,removeItem:C,context:{updateItem:p,removeItem:C},getHeightProp:u}}function Se(){return{isRegistered:!1,attachOnResize(){console.warn("StaggeredGridController must be registered with a StaggeredGrid before use.")},attachOnScrollListener(){console.warn("StaggeredGridController must be registered with a StaggeredGrid before use.")},deAttachOnResize(){console.warn("StaggeredGridController must be registered with a StaggeredGrid before use.")},deAttachOnScrollListener(){console.warn("StaggeredGridController must be registered with a StaggeredGrid before use.")},reposition(){console.warn("StaggeredGridController must be registered with a StaggeredGrid before use.")},requestReposition(){console.warn("StaggeredGridController must be registered with a StaggeredGrid before use.")}}}function ie(t){const r=be(),[h,b]=W(t.initialPosition);function w(a,o,f){const y=h();if(y==null||y.width!==a||o!==y.left||f!==y.top){const v={width:a,left:o,top:f,animateTo:y!=null};b(v)}}function c(){const a=t.ref();t.itemHeight==null&&a==null||r.updateItem(t.index(),t.spans||1,t.itemHeight||a.clientHeight,w)}X(c),Z(()=>r.removeItem(t.index()));function s(){const a=h(),o={...t};if(delete o.elementType,delete o.initialPosition,delete o.itemHeight,delete o.spans,delete o.index,delete o.children,delete o.transform,t.transform!=null)return{...o,...t.transform(a)};if(a==null)return o;const f=a.animateTo?{transition:"top, left 0.3s ease"}:{};return{...o,style:{position:"absolute",width:a.width+"px",left:a.left+"px",top:a.top+"px",...f,...t.style||{}}}}return()=>({...s(),onLoad:c})}function ve(t){const r=ie(t);return _(se,N({get component(){return t.elementType||"div"}},r,{get children(){return t.children}}))}const le=D("<div>"),Ge=D('<div><div>Name : <!#><!/><div>Span : <input type="number"></div><div>Height : <input type="number"></div><button>Add Next</button><button>Remove Me</button><button>Update Me</button><button>Swap Me'),we=D('<img alt="Random Image">'),xe=D('<div><label for="fitHorizontalGap">Show Images: </label><input type="checkbox"><label for="multiSpan">Multi Span: </label><input type="checkbox"><label for="alignment">Alignment : </label><select id="alignment"><option>Start</option><option>Center</option><option>End</option></select><label for="columnWidth">Column Width : </label><input type="number" id="columnWidth" min="0"><label for="columns">Total Columns : </label><input type="number" id="columns" min="0"><label for="horizontalGap">Horizontal Gap : </label><input type="number" id="horizontalGap" min="0"><label for="verticalGap">Vertical Gap : </label><input type="number" id="verticalGap" min="0"><label for="fitHorizontalGap">Fit Horizontal Gap : </label><input type="checkbox"><label for="infiniteGrid">Infinite Grid : </label><input type="checkbox">');function $e(){const[t,r]=W(!1),[h,b]=W(!1),[w,c]=W(!1),[s,a]=W({calculateHeight:!0,useElementWidth:!0,alignment:R.Center,columnWidth:300,columns:0,horizontalGap:10,verticalGap:10,fitHorizontalGap:!0,requestAppend:()=>{w()&&S(P([...G()],10))}});let o=Se();const f=20;function y(){return Math.floor(Math.random()*300+300)}function v(){let l=[];for(let u=0;u<f;u++)l.push(y());return l}function x(){let l=[];for(let u=0;u<f;u++)l.push(Math.floor(Math.random()*2)+1);return l}function P(l,u){const p=l.length,C=x(),e=v();for(let n=0;n<u;n++){let i;h()?i=C[n]:i=1,l.push({key:"Item"+(n+p)+i,name:"Item "+(n+p),span:i,width:i*s().columnWidth,height:e[n]})}return l}let[G,S]=W(P([],f)),g;const $=ye(()=>g,{gridController:o,options:s});return[_(Pe,{alignment:()=>s().alignment,setAlignment:l=>{a(u=>({...u,alignment:l}))},columnWidth:()=>s().columnWidth,setColumnWidth:l=>{a(u=>({...u,columnWidth:l}))},columns:()=>s().columns,setColumns:l=>{a(u=>({...u,columns:l}))},horizontalGap:()=>s().horizontalGap,setHorizontalGap:l=>{a(u=>({...u,horizontalGap:l}))},verticalGap:()=>s().verticalGap,setVerticalGap:l=>{a(u=>({...u,verticalGap:l}))},fitHorizontalGap:()=>s().fitHorizontalGap,setFitHorizontalGap:l=>{a(u=>({...u,fitHorizontalGap:l}))},images:t,setImages:r,multiSpan:h,setMultiSpan:b,infiniteGrid:w,setInfiniteGrid:c}),_(ne.Provider,{get value(){return $.context},get children(){const l=O(le),u=g;return typeof u=="function"?te(u,l):g=l,ee(l,_(ue,{get each(){return G()},children:(p,C)=>_(Ce,{get columnWidth(){return s().columnWidth},images:t,index:C,item:p,addNext:e=>{S(n=>{const i=[...n];return i.splice(e+1,0,{key:"newItem"+(e+1),name:"Item "+(e+1),height:y(),width:s().columnWidth,span:1}),i})},removeMe:e=>{S(n=>{let i=[...n];return i.splice(e,1),i})},updateMe:(e,n)=>{S(i=>{let d=[...i];return d[e]=n,d})},swapWithRandom:e=>{const n=G();let i=Math.floor(Math.random()*(n.length-1));if(i>0&&i<n.length){let d=[...n];d[e]=d[i],d[i]=n[e],S(d)}}})})),m(p=>de(l,{background:"#e3e3e3","margin-top":"1em",position:"relative",...$.getHeightProp()},p)),l}})]}function Ce(t){return[_(Q,{get when(){return t.images()},get children(){return _(He,N(()=>K(t,["images"])[1]))}}),_(Q,{get when(){return!t.images()},get children(){return _(_e,N(()=>K(t,["images"])[1]))}})]}function _e(t){let[r,h]=W(t.item.span),[b,w]=W(t.item.height),c;const s=ie({index:t.index,spans:r(),ref:()=>c});return(()=>{const a=O(Ge),o=a.firstChild,f=o.firstChild,y=f.nextSibling,[v,x]=ce(y.nextSibling),P=v.nextSibling,G=P.firstChild,S=G.nextSibling,g=P.nextSibling,$=g.firstChild,l=$.nextSibling,u=g.nextSibling,p=u.nextSibling,C=p.nextSibling,e=C.nextSibling,n=c;return typeof n=="function"?te(n,a):c=a,ge(a,N(s),!1,!0),o.style.setProperty("width","100%"),o.style.setProperty("background","skyblue"),o.style.setProperty("text-align","center"),o.style.setProperty("display","flex"),o.style.setProperty("flex-direction","column"),o.style.setProperty("align-items","center"),o.style.setProperty("justify-content","center"),ee(o,()=>t.item.name,v,x),S.addEventListener("change",i=>{t.item.span=parseInt(i.currentTarget.value),h(t.item.span)}),S.style.setProperty("width","4em"),l.addEventListener("change",i=>{t.item.height=parseInt(i.currentTarget.value),w(t.item.height)}),l.style.setProperty("width","4em"),u.$$click=()=>t.addNext(t.index()),p.$$click=()=>t.removeMe(t.index()),C.$$click=()=>t.updateMe(t.index(),{...t.item,name:t.item.name+"Updated"}),e.$$click=()=>t.swapWithRandom(t.index()),m(()=>t.item.height+"px"!=null?o.style.setProperty("height",t.item.height+"px"):o.style.removeProperty("height")),m(()=>S.value=r()),m(()=>l.value=b()),me(),a})()}function He(t){let{item:r,index:h}=t;return _(ve,{index:h,get spans(){return r.span},style:{transition:"left 0.3s ease,top 0.3s ease","overflow-x":"hidden"},get children(){const b=O(we);return m(()=>he(b,"src","https://picsum.photos/"+r.width+"/"+r.height)),b}})}function Pe(t){return[(()=>{const r=O(le);return r.style.setProperty("width","100%"),r.style.setProperty("height","3em"),r})(),(()=>{const r=O(xe),h=r.firstChild,b=h.nextSibling,w=b.nextSibling,c=w.nextSibling,s=c.nextSibling,a=s.nextSibling,o=a.firstChild,f=o.nextSibling,y=f.nextSibling,v=a.nextSibling,x=v.nextSibling,P=x.nextSibling,G=P.nextSibling,S=G.nextSibling,g=S.nextSibling,$=g.nextSibling,l=$.nextSibling,u=l.nextSibling,p=u.nextSibling,C=p.nextSibling,e=C.nextSibling;return r.style.setProperty("width","100%"),r.style.setProperty("display","flex"),r.style.setProperty("justify-content","center"),r.style.setProperty("gap","0.75em"),r.style.setProperty("padding","1em 0em"),r.style.setProperty("position","fixed"),r.style.setProperty("top","0"),r.style.setProperty("left","0"),r.style.setProperty("z-index","99"),r.style.setProperty("background","rgba(255,255,255,.3)"),r.style.setProperty("flex-wrap","wrap"),b.addEventListener("change",n=>t.setImages(n.currentTarget.checked)),c.addEventListener("change",n=>t.setMultiSpan(n.currentTarget.checked)),a.addEventListener("change",n=>{t.setAlignment(parseInt(n.currentTarget.value))}),x.addEventListener("change",n=>t.setColumnWidth(parseInt(n.currentTarget.value))),x.style.setProperty("width","4em"),G.addEventListener("change",n=>t.setColumns(parseInt(n.currentTarget.value))),G.style.setProperty("width","4em"),g.addEventListener("change",n=>t.setHorizontalGap(parseInt(n.currentTarget.value))),g.style.setProperty("width","4em"),l.addEventListener("change",n=>t.setVerticalGap(parseInt(n.currentTarget.value))),l.style.setProperty("width","4em"),p.addEventListener("change",n=>t.setFitHorizontalGap(n.currentTarget.checked)),e.addEventListener("change",n=>t.setInfiniteGrid(n.currentTarget.checked)),m(()=>b.checked=t.images()),m(()=>c.checked=t.multiSpan()),m(()=>a.value=t.alignment()),m(()=>o.value=R.Start),m(()=>f.value=R.Center),m(()=>y.value=R.End),m(()=>x.value=t.columnWidth()),m(()=>G.value=t.columns()),m(()=>g.value=t.horizontalGap()),m(()=>l.value=t.verticalGap()),m(()=>p.checked=t.fitHorizontalGap()),m(()=>e.checked=t.infiniteGrid()),r})()]}fe(["click"]);function ze(){return _($e,{})}export{ze as default};
